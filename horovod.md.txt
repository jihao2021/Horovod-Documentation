{"payload":{"allShortcutsEnabled":true,"fileTree":{"contents/user-guides/research-applications/data-science-ai-ml":{"items":[{"name":"horovod.md","path":"contents/user-guides/research-applications/data-science-ai-ml/horovod.md","contentType":"file"},{"name":"pnetcdf.md","path":"contents/user-guides/research-applications/data-science-ai-ml/pnetcdf.md","contentType":"file"},{"name":"ray.md","path":"contents/user-guides/research-applications/data-science-ai-ml/ray.md","contentType":"file"}],"totalCount":3},"contents/user-guides/research-applications":{"items":[{"name":"computational-biology","path":"contents/user-guides/research-applications/computational-biology","contentType":"directory"},{"name":"computational-chemistry","path":"contents/user-guides/research-applications/computational-chemistry","contentType":"directory"},{"name":"computational-engineering","path":"contents/user-guides/research-applications/computational-engineering","contentType":"directory"},{"name":"computational-mathematics","path":"contents/user-guides/research-applications/computational-mathematics","contentType":"directory"},{"name":"data-science-ai-ml","path":"contents/user-guides/research-applications/data-science-ai-ml","contentType":"directory"},{"name":"workflow-management-systems","path":"contents/user-guides/research-applications/workflow-management-systems","contentType":"directory"},{"name":"computational-biology.md","path":"contents/user-guides/research-applications/computational-biology.md","contentType":"file"},{"name":"computational-chemistry.md","path":"contents/user-guides/research-applications/computational-chemistry.md","contentType":"file"},{"name":"computational-engineering.md","path":"contents/user-guides/research-applications/computational-engineering.md","contentType":"file"},{"name":"computational-mathematics.md","path":"contents/user-guides/research-applications/computational-mathematics.md","contentType":"file"},{"name":"data-science-ai-ml.md","path":"contents/user-guides/research-applications/data-science-ai-ml.md","contentType":"file"},{"name":"workflow-management-systems.md","path":"contents/user-guides/research-applications/workflow-management-systems.md","contentType":"file"}],"totalCount":12},"contents/user-guides":{"items":[{"name":"accounts-and-allocations","path":"contents/user-guides/accounts-and-allocations","contentType":"directory"},{"name":"advanced-hpc-programming","path":"contents/user-guides/advanced-hpc-programming","contentType":"directory"},{"name":"carc-ondemand","path":"contents/user-guides/carc-ondemand","contentType":"directory"},{"name":"cloud-computing","path":"contents/user-guides/cloud-computing","contentType":"directory"},{"name":"data-science","path":"contents/user-guides/data-science","contentType":"directory"},{"name":"hpc-systems","path":"contents/user-guides/hpc-systems","contentType":"directory"},{"name":"life-sciences-computing","path":"contents/user-guides/life-sciences-computing","contentType":"directory"},{"name":"quick-start-guides","path":"contents/user-guides/quick-start-guides","contentType":"directory"},{"name":"research-applications","path":"contents/user-guides/research-applications","contentType":"directory"},{"name":"research-data-management","path":"contents/user-guides/research-data-management","contentType":"directory"},{"name":"secure-computing","path":"contents/user-guides/secure-computing","contentType":"directory"},{"name":"accounts-and-allocations.md","path":"contents/user-guides/accounts-and-allocations.md","contentType":"file"},{"name":"advanced-hpc-programming.md","path":"contents/user-guides/advanced-hpc-programming.md","contentType":"file"},{"name":"carc-ondemand.md","path":"contents/user-guides/carc-ondemand.md","contentType":"file"},{"name":"cloud-computing.md","path":"contents/user-guides/cloud-computing.md","contentType":"file"},{"name":"data-science.md","path":"contents/user-guides/data-science.md","contentType":"file"},{"name":"hpc-systems.md","path":"contents/user-guides/hpc-systems.md","contentType":"file"},{"name":"life-sciences-computing.md","path":"contents/user-guides/life-sciences-computing.md","contentType":"file"},{"name":"quick-start-guides.md","path":"contents/user-guides/quick-start-guides.md","contentType":"file"},{"name":"research-applications.md","path":"contents/user-guides/research-applications.md","contentType":"file"},{"name":"research-data-management.md","path":"contents/user-guides/research-data-management.md","contentType":"file"},{"name":"secure-computing.md","path":"contents/user-guides/secure-computing.md","contentType":"file"}],"totalCount":22},"contents":{"items":[{"name":"about","path":"contents/about","contentType":"directory"},{"name":"latest-news","path":"contents/latest-news","contentType":"directory"},{"name":"services","path":"contents/services","contentType":"directory"},{"name":"user-guides","path":"contents/user-guides","contentType":"directory"},{"name":"user-information","path":"contents/user-information","contentType":"directory"},{"name":".DS_Store","path":"contents/.DS_Store","contentType":"file"},{"name":"about.md","path":"contents/about.md","contentType":"file"},{"name":"asciidoc-demo.adoc","path":"contents/asciidoc-demo.adoc","contentType":"file"},{"name":"latest-news.md","path":"contents/latest-news.md","contentType":"file"},{"name":"services.md","path":"contents/services.md","contentType":"file"},{"name":"user-guides.md","path":"contents/user-guides.md","contentType":"file"},{"name":"user-information.md","path":"contents/user-information.md","contentType":"file"}],"totalCount":12},"":{"items":[{"name":".github","path":".github","contentType":"directory"},{"name":"contents","path":"contents","contentType":"directory"},{"name":"homepage","path":"homepage","contentType":"directory"},{"name":"images","path":"images","contentType":"directory"},{"name":"js","path":"js","contentType":"directory"},{"name":"src","path":"src","contentType":"directory"},{"name":"tailwindcss","path":"tailwindcss","contentType":"directory"},{"name":"templates","path":"templates","contentType":"directory"},{"name":".DS_Store","path":".DS_Store","contentType":"file"},{"name":".envrc","path":".envrc","contentType":"file"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"cabal.project","path":"cabal.project","contentType":"file"},{"name":"carc-website.cabal","path":"carc-website.cabal","contentType":"file"},{"name":"default.nix","path":"default.nix","contentType":"file"},{"name":"flake.lock","path":"flake.lock","contentType":"file"},{"name":"flake.nix","path":"flake.nix","contentType":"file"},{"name":"package-lock.json","path":"package-lock.json","contentType":"file"},{"name":"package.json","path":"package.json","contentType":"file"},{"name":"shell.nix","path":"shell.nix","contentType":"file"}],"totalCount":20}},"fileTreeProcessingTime":28.676533,"foldersToFetch":[],"reducedMotionEnabled":"system","repo":{"id":523825296,"defaultBranch":"main","name":"carc-website","ownerLogin":"uschpc","currentUserCanPush":true,"isFork":false,"isEmpty":false,"createdAt":"2022-08-11T11:16:49.000-07:00","ownerAvatar":"https://avatars.githubusercontent.com/u/61709996?v=4","public":false,"private":true,"isOrgOwned":true},"symbolsExpanded":true,"treeExpanded":true,"refInfo":{"name":"CW2-16-user-guides-section","listCacheKey":"v0:1694028677.0","canEdit":true,"refType":"branch","currentOid":"3eedac191e0b0ffdc4af69962a20e9a75afd4138"},"path":"contents/user-guides/research-applications/data-science-ai-ml/horovod.md","currentUser":{"id":90297164,"login":"jihao2021","userEmail":"haoji@usc.edu"},"blob":{"rawLines":null,"stylingDirectives":null,"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":null,"configFilePath":null,"networkDependabotPath":"/uschpc/carc-website/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":false,"repoAlertsPath":"/uschpc/carc-website/security/dependabot","repoSecurityAndAnalysisPath":"/uschpc/carc-website/settings/security_analysis","repoOwnerIsOrg":true,"currentUserCanAdminRepo":true},"displayName":"horovod.md","displayUrl":"https://github.com/uschpc/carc-website/blob/CW2-16-user-guides-section/contents/user-guides/research-applications/data-science-ai-ml/horovod.md?raw=true","headerInfo":{"blobSize":"2.43 KB","deleteInfo":{"deleteTooltip":"Delete this file"},"editInfo":{"editTooltip":"Edit this file"},"ghDesktopPath":"x-github-client://openRepo/https://github.com/uschpc/carc-website?branch=CW2-16-user-guides-section&filepath=contents%2Fuser-guides%2Fresearch-applications%2Fdata-science-ai-ml%2Fhorovod.md","gitLfsPath":null,"onBranch":true,"shortPath":"3246c6c","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fuschpc%2Fcarc-website%2Fblob%2FCW2-16-user-guides-section%2Fcontents%2Fuser-guides%2Fresearch-applications%2Fdata-science-ai-ml%2Fhorovod.md","isCSV":false,"isRichtext":true,"toc":[{"level":3,"text":"Installing Horovod with PyTorch","anchor":"installing-horovod-with-pytorch","htmlText":"Installing Horovod with PyTorch"},{"level":3,"text":"Additional information","anchor":"additional-information","htmlText":"Additional information"}],"lineInfo":{"truncatedLoc":"64","truncatedSloc":"45"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Markdown","languageID":222,"large":false,"loggedIn":true,"newDiscussionPath":"/uschpc/carc-website/discussions/new","newIssuePath":"/uschpc/carc-website/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/uschpc/carc-website/blob/CW2-16-user-guides-section/contents/user-guides/research-applications/data-science-ai-ml/horovod.md","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/uschpc/carc-website/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><table>\n  <thead>\n  <tr>\n  <th>title</th>\n  <th>date</th>\n  </tr>\n  </thead>\n  <tbody>\n  <tr>\n  <td><div dir=\"auto\">Horovod</div></td>\n  <td><div dir=\"auto\">Fri, 07 Jul 2023 00:01:00 UTC</div></td>\n  </tr>\n  </tbody>\n</table>\n\n<p dir=\"auto\"><a href=\"https://horovod.ai/\" rel=\"nofollow\">Horovod</a> is an open source toolkit, originally developed at Uber, that facilitates distributed Deep Learning computations while requiring minimal modifications to the existing TensorFlow and PyTorch codes. This package is available under the Apache 2.0 license (<a href=\"https://github.com/horovod/horovod\">https://github.com/horovod/horovod</a>).</p>\n<p dir=\"auto\">Popular Deep Learning packages, like TensorFlow and PyTorch, are designed to rely on one single GPU, or at most on one node, to conduct the underlying calculations. With an ever-increasing demand for more complex models, this limitation poses difficulties for many research teams scaling their research models and testing them in real-life applications.</p>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-installing-horovod-with-pytorch\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#installing-horovod-with-pytorch\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>Installing Horovod with PyTorch</h3>\n<p dir=\"auto\">To install and test <strong>Horovod</strong> with <strong>PyTorch</strong>, create a new Conda environment:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"module purge\nmodule load usc\nmodule load nccl/2.12.12-1\nmodule load cuda/11.6.2\nmodule load cmake/3.23.2\nmodule load conda/23.3.1\nmamba create -n horovod-pytorch\nmamba activate horovod-pytorch\nmamba install pytorch torchvision torchaudio pytorch-cuda=11.7 -c pytorch -c nvidia -y\nmodule unload conda\nHOROVOD_NCCL_HOME=/spack/2206/apps/linux-centos7-x86_64_v3/gcc-11.3.0/nccl-2.12.12-1-e6klrou HOROVOD_GPU_ALLREDUCE=NCCL pip install --no-cache-dir horovod\"><pre lang=\"plaintext\" class=\"notranslate\"><code>module purge\nmodule load usc\nmodule load nccl/2.12.12-1\nmodule load cuda/11.6.2\nmodule load cmake/3.23.2\nmodule load conda/23.3.1\nmamba create -n horovod-pytorch\nmamba activate horovod-pytorch\nmamba install pytorch torchvision torchaudio pytorch-cuda=11.7 -c pytorch -c nvidia -y\nmodule unload conda\nHOROVOD_NCCL_HOME=/spack/2206/apps/linux-centos7-x86_64_v3/gcc-11.3.0/nccl-2.12.12-1-e6klrou HOROVOD_GPU_ALLREDUCE=NCCL pip install --no-cache-dir horovod\n</code></pre></div>\n<p dir=\"auto\">Use the following script for carrying out the benchmark test using synthetic images on PyTorch:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"wget https://raw.githubusercontent.com/horovod/horovod/master/examples/pytorch/pytorch_synthetic_benchmark.py\"><pre lang=\"plaintext\" class=\"notranslate\"><code>wget https://raw.githubusercontent.com/horovod/horovod/master/examples/pytorch/pytorch_synthetic_benchmark.py\n</code></pre></div>\n<p dir=\"auto\">To launch the computations, ask for 1 node with 2X P100 GPUs:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"salloc --partition=gpu --gres=gpu:p100:2 --time=01:00:00 --exclusive\"><pre lang=\"plaintext\" class=\"notranslate\"><code>salloc --partition=gpu --gres=gpu:p100:2 --time=01:00:00 --exclusive\n</code></pre></div>\n<p dir=\"auto\">Then follow the steps below:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"module purge\nmodule load usc\nmodule load nccl/2.12.12-1\nmodule load cuda/11.6.2\nmodule load conda/23.3.1\n\nconda activate horovod-pytorch\n\nsrun --mpi=pmix_v2 -n 2 python pytorch_synthetic_benchmark.py &gt; out\"><pre lang=\"plaintext\" class=\"notranslate\"><code>module purge\nmodule load usc\nmodule load nccl/2.12.12-1\nmodule load cuda/11.6.2\nmodule load conda/23.3.1\n\nconda activate horovod-pytorch\n\nsrun --mpi=pmix_v2 -n 2 python pytorch_synthetic_benchmark.py &gt; out\n</code></pre></div>\n<p dir=\"auto\">Below is the strong scaling plot using these tests on Discovery nodes with 2x P100 Nvidia GPUs:</p>\n<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"/uschpc/carc-website/blob/CW2-16-user-guides-section/images/scaling-horovod-synthetic-P100.png\"><img src=\"/uschpc/carc-website/raw/CW2-16-user-guides-section/images/scaling-horovod-synthetic-P100.png\" alt=\"drawing\" width=\"800\" style=\"max-width: 100%;\"></a></p>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-additional-information\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#additional-information\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>Additional information</h3>\n<p dir=\"auto\">If you have questions about or need help with Horovod, please <a href=\"/uschpc/carc-website/blob/CW2-16-user-guides-section/user-support/ticket-submission\">submit a help ticket</a> and we will assist you.</p>\n<ul dir=\"auto\">\n<li><a href=\"https://horovod.readthedocs.io/en/stable/\" rel=\"nofollow\">Horovod documentation</a></li>\n<li><a href=\"https://horovod.ai/getting-started/\" rel=\"nofollow\">Horovod quick start guide</a></li>\n</ul>\n</article>","renderedFileInfo":null,"shortPath":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"uschpc","repoName":"carc-website","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":null,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timedOut":false,"notAnalyzed":true,"symbols":[]}},"copilotInfo":null,"csrf_tokens":{"/uschpc/carc-website/branches":{"post":"weSOhjxVj6CKYEUVQA8pIMQD_9_eEbbsizirB_Vt7RiaDIQIwpwhFDkDR3jYQf1Evt0n32CUh9bjS4j97CC0Pw"},"/repos/preferences":{"post":"oviDd5JUPYQACKVwZ1Hb1As_wiS1SWzlNBQkrF3ABxjepEPEbXjQdy3Dx-I-bB9t5MGg8bpr5w8ELjtvZaqpsQ"}}},"title":"carc-website/contents/user-guides/research-applications/data-science-ai-ml/horovod.md at CW2-16-user-guides-section Â· uschpc/carc-website"}